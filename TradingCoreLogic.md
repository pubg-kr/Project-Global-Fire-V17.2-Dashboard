# 🏛️ PROJECT GLOBAL FIRE : Master Protocol (Ver 19.3.4)
**"The Variable Logic with Tax Shield (변수 기반 완전 자동화 + 세금 방어)"**

*   **System Owner:** 30세 프로그래머 (Busan, KR / 한화오션)
*   **Chief Risk Officer (CRO):** Gemini (AI)
*   **Monthly Input:** 5,000,000 KRW (Total)

---

## 0. 핵심 전제 (Prerequisites)
1.  **지표 기준 (Benchmark):** 본 시스템의 모든 기술적 지표(RSI, MDD, MA 등)는 **[QQQ]**를 기준으로 판단합니다. (TQQQ 차트 X)
2.  **자산 기준 (Asset):** 매수/매도 실행은 **[TQQQ]**로 수행합니다.

## 0.5 🚨 버블 붕괴 조기 경보 (Bubble Warning)
**"파티가 끝나기 전에 문 근처로 이동하십시오."**
아래 징후가 포착되면 시스템은 **[방어 모드]**로 전환하여 주식 목표 비중을 축소합니다.

### 🛡️ 진입 조건 (Defense Mode ON)
*   **징후 1: 장단기 금리차 역전 후 정상화 (10Y - 3M)**
    *   *Condition:* (10년물 - 3개월물) 금리차가 마이너스(역전) 상태에서 **0을 상향 돌파**할 때.
    *   *Risk:* 역전 자체보다 역전 후 급격히 정상화될 때가 진짜 '시스템 붕괴(Crash)' 시점임.
*   **징후 2: VIX(공포지수)의 기조적 상승**
    *   *Condition:* VIX가 **20 위에서 5거래일 이상** 종가 기준으로 안착할 때. (일시적 스파이크 제외)
    *   *Logic:* VIX 20은 '방어 모드(방탄복 착용)' 신호이며, VIX 30은 '위기 대응(공격적 매수)'의 영역임.
*   **징후 3: 이동평균선 이탈 (Trend Health Check)**
    *   *Condition:* QQQ 주가가 **주봉 20선(20-week MA) 아래로 하향 돌파(Dead Cross)**하고 **2주 이상** 회복하지 못할 때.
    *   *Logic:* "가격은 모든 뉴스에 선행한다." 주봉 20선은 시장의 생명선이며, 이것이 무너짐은 **'상승 추세의 엔진이 꺼졌음'**을 의미함.

### 🏳️ 해제 조건 (Defense Mode OFF)
*   **신호 1: VIX 지수의 하락 (Stabilization)**
    *   *Condition:* 공포지수(VIX)가 급등(30 이상)했다가 다시 **20 미만으로 내려와 5거래일 이상** 유지될 때.
*   **신호 2: 주봉 RSI의 과매도 탈출 (Rebound)**
    *   *Condition:* QQQ 주봉 RSI가 **30~40 수준의 바닥**을 찍고 다시 **45~50 위로** 고개를 들 때.
*   **신호 3: 금리 역전 해소 (Normalization)**
    *   *Condition:* 역전되었던 장단기 금리차가 정상화(양수 전환)되고, 시장이 그 충격을 한 차례 소화했을 때.

**[Action: 방어 모드 해제 시]**
*   **복귀 전략:** 위 신호가 확인되면 **한 번에** 원래 Phase의 `Target_Stock` 비중으로 복귀합니다.

**[Action: 방어 모드 발동 시]**
*   **Target_Stock (주식 목표) 비중을 강제로 -10%p 하향 조정.**
    *   *예:* Phase 3 (60%) -> **50%**로 축소 운영.
*   **RSI 매도 기준 강화:** 80 -> **75**로 하향 (더 빨리 팜).

---

## 1. 시스템 아키텍처 (System Architecture)
*Ver 19.1 필수 패치: 3-Core 계좌 운용*

| 계좌명 | 별칭 | 용도 및 규칙 |
| :--- | :--- | :--- |
| **계좌 A** | **The Vault** | **[무한 적립]** 매도 금지, 장기 보유 물량 저장소. |
| **계좌 B** | **The Sniper** | **[매매/현금]** 리밸런싱, 위기 대응, 현금 보관용. |
| **계좌 C** | **The Bunker** | **[세금/비상]** 수익금의 22% 강제 격리. (절대 투자 금지) |

---

## 2. 🚦 논리 충돌 해결 매트릭스 (Conflict Resolution)
**"두 가지 신호가 동시에 발생할 때, 아래 우선순위에 따라 행동합니다."**

| 상황 (Case) | 충돌 신호 1 | 충돌 신호 2 | **최종 판결 (Winner)** | 이유 (Logic) |
| :--- | :--- | :--- | :--- | :--- |
| **손실 중 과열** | 🚨 RSI 80 (매도) | 🛑 계좌 손실 중 | **✅ HOLD (매도 금지)** | 손실 확정은 복리 엔진을 파괴함. 본전까지 대기. |
| **손실 중 리밸런싱** | ⚖️ 비중 초과 (매도) | 🛑 계좌 손실 중 | **✅ HOLD (매도 금지)** | 자산 배분보다 원금 보전이 상위 개념. |
| **데드캣 바운스** | 📉 MDD -30% (폭락) | 🚨 RSI 80 (광기) | **🚨 SELL (부분 익절)** | 하락장 속 급등(RSI 80)은 현금 확보의 기회 (보유분). |
| **전시 상황 월급** | 🛑 RSI 75 (매수 금지) | 📉 MDD -30% (폭락) | **💰 BUY (적극 매수)** | [월급]은 타이밍 안 잼. 폭락장이면 무조건 수집. |
| **현금 부족 기회** | 💰 RSI < 60 (매수) | 💸 현금 부족 | **🩸 Squeeze (쥐어짜기)** | 저점 매수 기회는 빚을 내지 않는 선에서 최대 확보. |

---

## 3. 마스터 알고리즘 (Flowchart)
**"위에서부터 순서대로 `Check`하고, `True`면 실행 후 종료합니다."**

### [Priority 1] 생존 헌법 (Constitution)
*   **Condition:** 내 계좌 통합 수익률 < **+1.5%** (수수료 포함 실질 손실)
*   **Action:**
    *   🛑 **[절대 매도 금지]**
    *   *System:* 아래 [Step 2] 광기 차단이나 [Step 4] 리밸런싱 매도 신호가 떠도 **무시하고 무효화**합니다.
    *   *Logic:* 장부상 0%는 수수료 감안 시 손실임. +1.5% 여유 마진 확보 필요.

### [Priority 2] 광기 차단 (Circuit Breaker)
*   **Condition:** QQQ 주봉 RSI ≥ 80 **AND** 계좌 수익 중
*   **Action:**
    *   🚨 **[강제 익절]**
    *   **Formula:** 현금 비중이 **`[Target_Cash + 10%p]`**가 될 때까지 매도.
    *   **Priority:** **평단가 높은 [계좌 B] 우선 매도** → 부족하면 [계좌 A] 매도. (절세)
    *   **Tax Rule:** 실현 수익금의 **22%**는 즉시 **[계좌 C]**로 이체.

### [Priority 3] 위기 대응 (Crisis Management)
*   **Condition:** QQQ MDD 임계값 돌파 (-15%, -25%...)
*   **Action:**
    *   📉 **[긴급 매수]** (계좌 B의 Sniper 현금 사용)
    *   **Formula:** 보유 현금 잔고의 **N%** 투입.
        *   **MDD -15%** : 현금의 **20%** 투입 (Sniper 첫 발사 - 잔파도 무시)
        *   **MDD -25%** : 현금의 **30%** 투입 (약세장 공포)
        *   **MDD -35%** : 현금의 **30%** 투입 (금융위기급 패닉)
        *   **MDD -45%** : 현금의 **20%** 투입 (시스템 붕괴 임박 / All-In)
    *   **Exception:** MDD **-50%** 초과 하락 시, 현금은 없으므로 **[월급 100%]** 무한 투입으로 방어.

### [Priority 4] 자동 리밸런싱 (Auto-Balancing)
*   **Condition:** 주식 비중 벗어남 **AND** 수익 중
*   **Action:**
    *   ⚖️ **[비중 복귀]**
    *   **Over (과열):** 팔아서 **`[Target_Stock]`**으로 맞춤. (수익 중일 때만)
    *   **Under (침체):** 사서 **`[Target_Stock]`**으로 맞춤.

### [Priority 5] 월급날 루틴 (Monthly Routine)
*   **Condition:** 오늘이 월급날인가?
*   **Action:** MDD 및 RSI 상태에 따라 아래 **[매수 공식]** 실행.

---

## 4. 환경 변수 설정 (Configuration)

| Phase | 자산 구간 | **Target_Stock (주식목표)** | **Target_Cash (현금목표)** |
| :--- | :--- | :---: | :---: |
| **Phase 0** | **0 ~ 1억 (Seed)** | **90%** | **10%** |
| Phase 1 | ~ 5억 | 80% | 20% |
| Phase 2 | ~ 10억 | 70% | 30% |
| Phase 3 | ~ 20억 | 60% | 40% |
| Phase 4 | ~ 25억 | 50% | 50% |
| Phase 5 | 30억+ | 40% | 60% |

---

## 5. 월급 매수 공식 (Monthly Formula)

### ⚠️ 특수 전시 상황 (War Time)
*   **Condition:** **MDD -30% 이하** (폭락장 지속 중)
*   **Action:** **RSI 무시하고 월급 100% TQQQ 매수.** (현금 적립 중단)

### 🟢 일반 상황 (MDD -30% 이상)
*   **RSI 기준 매수표:**

| RSI 구간 | 상태 | 매수 금액 (Formula) |
| :--- | :--- | :--- |
| **80 이상** | **광기** | **매수 0원** (월급 100% 현금 저축 → 계좌 B). |
| **75 ~ 80** | **과열** | **매수 0원** (월급 100% 현금 저축 → 계좌 B). |
| **60 ~ 75** | **표준** | 월급의 **`[Target_Stock]`%** 매수. |
| **60 미만** | **기회** | **💰 스마트 매수 (아래 로직 참조)** |

**[RSI 60 미만 시: 스마트 매수 로직]**

*   **Case A: 현금 부자 (현재 현금 > `Target_Cash`)**
    *   **Action:** **1.5배 부스터**
    *   **Formula:** (월급 × `Target_Stock`) × **1.5** 매수.

*   **Case B: 현금 거지 (현재 현금 < `Target_Cash`)**
    *   **Action:** **쥐어짜기 (Squeeze)**
    *   **Formula:** 월급의 **`[Target_Stock + 10%p]`** 매수.

---

## 🖨️ 책상 부착용 요약본 (Desk Summary)

### 1. 절대 헌법 (Priority 1)
*   **파란불(손실)이면 RSI 100이어도 죽어도 안 판다.**
*   **익절 시 22%는 즉시 계좌 C로 유배 보낸다.**

### 2. 매도 공식 (수익 중일 때만)
*   **순서:** **계좌 B(Sniper)**부터 판다. (세금 절약)
*   **RSI 80:** 현금 **`Target + 10%`** 만들기.
*   **비중 초과:** 현금 **`Target`** 만들기.

### 3. 매수 공식 (Efficiency Optimized)
*   **MDD 폭락(-30%↓):** **월급 100%** 투입.
*   **Sniper 현금 투입:** **[-15% / -25% / -35% / -45%]** 구간마다 분할 투입.
*   **비중 미달:** 주식 **`Target`** 만들기.
*   **RSI 60 미만:** 현금 많으면 1.5배, 없으면 +10%p.

**Authorized by:** Gemini (CRO)
